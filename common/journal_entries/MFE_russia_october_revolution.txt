# First JE and can prevent the revolution
je_russia_october_revolution_prevention = {
	icon = "gfx/interface/icons/event_icons/event_scales.dds"

	on_monthly_pulse = {
		effect = {
			change_variable = {
				name = october_revolution_prevention_var
				add = 1
			}
		}
	}

	complete = {
		scope:journal_entry = { is_goal_complete = no }
		has_insurrectionary_interest_groups = no
		is_at_war = no
		owns_entire_state_region = STATE_INGRIA
		OR = {
			has_law = law_type:law_appointed_bureaucrats
			has_law = law_type:law_elected_bureaucrats
		}
		OR = {
			has_law = law_type:law_regulatory_bodies
			has_law = law_type:law_worker_protections
		}
		OR = {
			has_law = law_type:law_census_voting
			has_law = law_type:law_universal_suffrage
		}
	}

	on_complete = {
		remove_modifier = october_revolution_prevention_active_modifier
		hidden_effect = {
			if = {
				limit = {
					root.ruler = {
						has_modifier = bloody_sunday_massacre_character
					}
				}
				root.ruler = {
					remove_modifier = bloody_sunday_massacre_character
				}
			}
			every_scope_state = {
				limit = {
					owner = ROOT
					OR = {
						region = sr:region_russia
						region = sr:region_dnieper
						region = sr:region_caucasus
						region = sr:region_baltic
					}
				}
				if = {
					limit = {
						has_modifier = bloody_sunday_massacre_state
					}
					remove_modifier = bloody_sunday_massacre_state
				}
			}
		}
		trigger_event = {
			id = mfe_october_revolution.3
		}
	}

	timeout = 3650 # 10 years

	on_timeout = {
		remove_modifier = october_revolution_prevention_active_modifier
		trigger_event = {
			id = mfe_october_revolution.4
		}
	}

	current_value = {
		value = root.var:october_revolution_prevention_var
	}

	goal_add_value = {
		value = 120
	}

	progressbar = yes

	weight = 10000

	should_be_pinned_by_default = yes
}

# JE to prepare for the revolution
je_russia_february_revolution = {
	icon = "gfx/interface/icons/event_icons/event_protest.dds"

	on_monthly_pulse = {
		random_events = {
			92 = 0
			2 = mfe_october_revolution.7
			2 = mfe_october_revolution.8
			2 = mfe_october_revolution.9
			2 = mfe_october_revolution.10
		}
		effect = {
			change_variable = {
				name = february_revolution_var
				add = 1
			}
		}
	}

	complete = {
		scope:journal_entry = { is_goal_complete = no }
		has_insurrectionary_interest_groups = no
		is_at_war = no
		owns_entire_state_region = STATE_INGRIA
		OR = {
			has_law = law_type:law_appointed_bureaucrats
			has_law = law_type:law_elected_bureaucrats
		}
		OR = {
			has_law = law_type:law_regulatory_bodies
			has_law = law_type:law_worker_protections
		}
		OR = {
			has_law = law_type:law_census_voting
			has_law = law_type:law_universal_suffrage
		}
		OR = {
			has_law = law_type:law_parliamentary_republic
			has_law = law_type:law_council_republic
		}
	}

	on_complete = {
		remove_modifier = february_revolution_active_modifier
		hidden_effect = {
			if = {
				limit = {
					root.ruler = {
						has_modifier = february_revolution_character_modifier
					}
				}
				root.ruler = {
					remove_modifier = february_revolution_character_modifier
				}
			}
			every_scope_state = {
				limit = {
					owner = ROOT
					OR = {
						region = sr:region_russia
						region = sr:region_dnieper
						region = sr:region_caucasus
						region = sr:region_baltic
					}
				}
				if = {
					limit = {
						has_modifier = february_revolution_state_modifier
					}
					remove_modifier = february_revolution_state_modifier
				}
			}
		}
		trigger_event = {
			id = mfe_october_revolution.5
		}
	}

	timeout = 730 # 2 years

	on_timeout = {
		remove_modifier = february_revolution_active_modifier
		trigger_event = {
			id = mfe_october_revolution.6
		}
	}

	current_value = {
		value = root.var:february_revolution_var
	}

	goal_add_value = {
		value = 24
	}

	progressbar = yes

	weight = 10000

	should_be_pinned_by_default = yes
}

# JE for October Revolution with pulsating events + mandatory civil war (should be able to choose sides)
je_russia_october_revolution = {
	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	complete = {
		scope:journal_entry = {
			is_goal_complete = yes
		}
	}
	
	on_complete = {
		trigger_event = { id = liberalism.1 }
	}

	timeout = 5475 # 15 years

	on_timeout = {
		remove_modifier = sick_man_of_europe
		trigger_event = {
			id = sick_man.3
		}
	}

	current_value = {
		value = var:october_revolution_var
	}

	goal_add_value = {
		add = 4
	}

	progressbar = yes
	
	weight = 10000

	should_be_pinned_by_default = yes
}

# Freedom of Trade
je_russia_october_revolution_2 = {
	icon = "gfx/interface/icons/event_icons/event_trade.dds"

	complete = {
		has_law = law_type:law_free_trade
		scope:journal_entry = {
			is_goal_complete = yes
		}
	}

	current_value = {
		value = root.num_trade_routes
	}

	goal_add_value = {
		value = root.num_trade_routes
		multiply = 0.25
	}
	
	on_complete = {
		trigger_event = { id = liberalism.2 }
	}

	progressbar = yes
	
	weight = 5000
}

# Freedom of Thought
je_russia_october_revolution_3 = {
	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	complete = {
		OR = {
			has_law = law_type:law_right_of_assembly
			has_law = law_type:law_protected_speech
		}
		OR = {
			has_law = law_type:law_freedom_of_conscience
			has_law = law_type:law_total_separation
		}
		any_scope_building = {
			is_building_type = building_university
			level >= 3
			occupancy > 0.9
		}
		any_scope_building = {
			is_building_type = building_arts_academy
			level >= 3
			occupancy > 0.9
		}
	}
	
	on_complete = {
		trigger_event = { id = liberalism.3 }
	}
	
	weight = 5000
}

# The New Colossus
je_russia_october_revolution_4 = {
	icon = "gfx/interface/icons/event_icons/event_portrait.dds"

	complete = {
		OR = {
			has_law = law_type:law_freedom_of_conscience
			has_law = law_type:law_total_separation
		}
		has_law = law_type:law_slavery_banned
		has_law = law_type:law_multicultural
		has_law = law_type:law_no_migration_controls
		average_sol >= 12
	}
	
	on_complete = {
		trigger_event = { id = liberalism.4 }
	}
	
	weight = 5000
}